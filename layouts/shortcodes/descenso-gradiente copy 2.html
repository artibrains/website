<link rel="stylesheet" href="/css/unified-demos.css">
<link rel="stylesheet" href="/css/gradient-descens-graphs.css">
<div class="container responsive-container">
    <!-- Panel lateral: Parámetros y Explicaciones -->
    <aside class="sidebar" style="grid-area: controls; display: flex; flex-direction: column; gap: 1rem;">
        <!-- Pestañas para 1D y 2D -->
        <div class="tabs" style="margin-bottom: 1rem;"></div>
        <button class="tab-button active" onclick="showTab('1d')">1D (y = f(x))</button>
        <button class="tab-button" onclick="showTab('2d')">2D (z = f(x, y))</button>
</div>
<div class="controls">
    <!-- Controles para 1D -->
    <div id="controls-1d" class="tab-content active" style="margin-bottom: 1rem;">
        <label for="functionInput1D">Función f(x):</label>
        <input type="text" id="functionInput1D" value="x^2">
        <label for="startPointInputX">Punto Inicial (x₀):</label>
        <input type="number" id="startPointInputX" value="8" step="any">
    </div>
    <!-- Controles para 2D -->
    <div id="controls-2d" class="tab-content" style="margin-bottom: 1rem;"></div>
    <label for="functionInput2D">Función f(x, y):</label>
    <input type="text" id="functionInput2D" value="(x^2 + y - 11)^2 + (x + y^2 - 7)^2">
    <label for="startPointInputX2D">Punto Inicial (x₀):</label>
    <input type="number" id="startPointInputX2D" value="-4" step="any">
    <label for="startPointInputY2D">Punto Inicial (y₀):</label>
    <input type="number" id="startPointInputY2D" value="4" step="any">
</div>
<h3 style="margin-bottom: 1rem;">Parámetros del Algoritmo</h3>
<div class="control-section" style="margin-bottom: 1rem;"></div>
<label for="learningRateType">Tipo de Tasa de Aprendizaje (α):</label>
<select id="learningRateType">
    <option value="constant" selected>Constante</option>
    <option value="decaySimple">Decreciente (Simple: α₀ / √iter)</option>
    <option value="decayExponential">Decreciente (Exponencial: α₀ * γ^iter)</option>
</select>
<div id="lrExplanationDiv" class="explanation-box">
    <p id="lrExplanationText">Selecciona un tipo de tasa de aprendizaje para ver su descripción.</p>
    <button id="showLrModalBtn" class="demo-btn demo-btn-secondary">Comparar modos</button>
</div>
</div>
<div class="control-section">
    <div id="lrConstantDiv">
        <label for="learningRateConstant">Valor de α (Constante o Inicial α₀):</label>
        <input type="number" id="learningRateConstant" value="0.1" step="any" min="0">
    </div>
    <div id="lrExponentialDiv" style="display: none;">
        <label for="learningRateDecayRate">Factor Decaimiento Exponencial (γ):</label>
        <input type="number" id="learningRateDecayRate" value="0.95" step="0.01" min="0.1" max="1.0">
        <small>Valor entre 0 y 1 (e.g., 0.95). Más cercano a 1, más lento decae.</small>
    </div>
    <label for="maxIterations">Máx. Iteraciones (N):</label>
    <input type="number" id="maxIterations" value="50" min="1" step="1">
    <label for="tolerance">Tolerancia (|∇f|):</label>
    <input type="number" id="tolerance" value="0.001" step="any" min="0">
</div>
</div>
<div class="control-section button-group">
    <button class="demo-btn demo-btn-primary" id="startButton">Iniciar / Continuar</button>
    <button class="demo-btn demo-btn-primary" id="stepButton">Paso Siguiente</button>
    <button class="demo-btn demo-btn-secondary" id="resetButton">Reiniciar</button>
</div>
</aside>

<!-- NUEVO: Modal para comparación de modos de convergencia (unificado) -->
<div id="lrModal" class="modal">
    <div class="modal-content">
        <button id="closeLrModalBtn" class="close-button" aria-label="Cerrar">&times;</button>
        <h2 class="demo-mb-md">Comparativa de Modos de Convergencia</h2>
        <table class="lr-compare-table">
            <thead>
                <tr>
                    <th>Modo</th>
                    <th>Ventajas</th>
                    <th>Inconvenientes</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Constante</strong><br><small>α fijo</small></td>
                    <td>
                        <ul>
                            <li>Fácil de entender y configurar.</li>
                            <li>Puede ser eficiente si se elige bien α.</li>
                        </ul>
                    </td>
                    <td>
                        <ul>
                            <li>Si α es muy grande, puede diverger (no converge).</li>
                            <li>Si α es muy pequeño, la convergencia es muy lenta.</li>
                            <li>No se adapta a la cercanía del mínimo.</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td><strong>Decreciente Simple</strong><br><small>α₀ / √iter</small></td>
                    <td>
                        <ul>
                            <li>Empieza con pasos grandes y los reduce automáticamente.</li>
                            <li>Reduce el riesgo de saltarse el mínimo al final.</li>
                        </ul>
                    </td>
                    <td>
                        <ul>
                            <li>Puede reducir demasiado rápido y estancarse lejos del mínimo.</li>
                            <li>La velocidad de reducción depende mucho de α₀.</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td><strong>Decreciente Exponencial</strong><br><small>α₀ · γ^iter</small></td>
                    <td>
                        <ul>
                            <li>Permite controlar con precisión la velocidad de reducción.</li>
                            <li>Puede ajustarse para converger rápido y luego afinar despacio.</li>
                        </ul>
                    </td>
                    <td>
                        <ul>
                            <li>Requiere ajustar dos parámetros (α₀ y γ).</li>
                            <li>Si γ es muy bajo, puede dejar de avanzar pronto.</li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
        <div class="modal-footer" style="margin-top: 1rem;">
            <button id="closeLrModalBtn2" class="demo-btn demo-btn-primary">Cerrar</button>
        </div>
    </div>
</div>

<!-- Área de Visualización Principal -->
<main class="main-panel responsive-main" style="grid-area: visualization;">
    <div class="main-content-wrapper">
        <h2 class="main-title">Gráfica de la Función</h2>
        <div id="plotDiv1D" class="plot-container tab-content active" style="height:500px; min-height:300px;"></div>
        <div id="plotDiv2D" class="plot-container tab-content" style="height:500px; min-height:300px;"></div>
        <div id="finalResultBox" class="explanation-box" style="display:none; margin-top:18px;"></div>
    </div>

    <div class="bottom-panels">
        <div class="error-plot-area">
            <h2 class="main-title">Evolución del Error (|∇f|)</h2>
            <div id="errorPlotDiv" class="plot-container"></div>
        </div>
    </div>
</main>
</div>
<!-- Librería Math.js para cálculos -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script>
<!-- Librería Plotly.js para gráficas -->
<script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
<script src="/js/Metodo-del-descenco-del-gradiente/descenso-gradiente.js"></script>